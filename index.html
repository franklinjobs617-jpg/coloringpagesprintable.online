<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="language" content="en-US">
    <meta name="geo.region" content="US,CA">
    <meta name="geo.placename" content="United States, Canada">
    <meta name="description" content="Free printable coloring pages for kids (3-12), teens & adults. Find educational sheets, stress relief designs, and popular themes like unicorn, Pokemon & Christmas. No sign-up required.">
    <meta name="keywords" content="printable coloring pages, free coloring sheets, adult coloring pages, kids coloring pages, unicorn coloring, pokemon coloring sheets, christmas coloring pages">
    <meta name="robots" content="index, follow">
    <!-- 技术SEO: 添加canonical标签 -->
    <link rel="canonical" href="https://coloringpagesprintable.online/">
    <!-- 引用robots和sitemap -->
    <link rel="sitemap" type="application/xml" title="Sitemap" href="https://coloringpagesprintable.online/sitemap.xml">
    <!-- Open Graph -->
    <meta property="og:title" content="Free Printable Coloring Pages | For Kids, Teens & Adults (US/CA)">
    <meta property="og:description" content="Download free coloring pages printable—no sign-up. Educational sheets for 5 year olds, stress relief designs for adults, and popular themes for all ages.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://coloringpagesprintable.online/">
    <meta property="og:image" content="https://coloringpagesprintable.online/images/featured-coloring-pages.jpg">
    <meta property="og:image:alt" content="Collection of free printable coloring pages for kids and adults">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free Printable Coloring Pages (US/CA)">
    <meta name="twitter:description" content="Free coloring sheets for kids (3-12), teens & adults. Educational, stress relief, and popular themes—no sign-up required.">
    <meta name="twitter:image" content="https://coloringpagesprintable.online/images/featured-coloring-pages.jpg">
    <meta name="twitter:creator" content="@ColoringPagesUS">
    <!-- External Resources -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "tfo8ah57w4");
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5QGJ254569"></script>
    <script async src="https://docs.opencv.org/4.7.0/opencv.js"></script>

    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-5QGJ254569');
    </script>
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B35', // US/CA family-friendly warm orange
                        secondary: '#4285F4', // Trusted blue for CTAs
                        neutral: '#F9F7F3', // Soft background for readability
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto { content-visibility: auto; }
            .text-shadow { text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
            .hover-lift { transition: transform 0.3s ease; }
            .hover-lift:hover { transform: translateY(-5px); }
            .free-badge {
                @apply absolute top-3 right-3 bg-primary text-white text-xs font-bold px-2 py-1 rounded-full;
            }
            /* 移动端优化：增大点击区域 */
            .filter-button {
                @apply px-4 py-2 min-h-[44px] min-w-[44px];
            }
            /* 无障碍适配：减少动画 */
            @media (prefers-reduced-motion: reduce) {
                .hover-lift { transition: transform 0.1s ease; }
                * { animation-duration: 0.001s !important; animation-iteration-count: 1 !important; }
            }
        }
    </style>
    <!-- Schema Markup (FAQ + Organization) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Coloring Pages Printable",
        "url": "https://coloringpagesprintable.online/",
        "logo": "https://coloringpagesprintable.online/images/logo.png",
        "areaServed": [{"@type": "Country","name": "United States"},{"@type": "Country","name": "Canada"}],
        "contactPoint": {"@type": "ContactPoint","telephone": "+1-555-123-4567","contactType": "customer service","availableLanguage": "English"}
    }
    </script>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "Are your coloring pages printable free to download?",
                "acceptedAnswer": {"@type": "Answer","text": "Yes! All coloring pages on our site are 100% free to download and print—no sign-up, registration, or payment required. Simply click the 'Download PDF' button on any resource page."}
            },
            {
                "@type": "Question",
                "name": "What size are the printable coloring pages?",
                "acceptedAnswer": {"@type": "Answer","text": "Our coloring pages are optimized for US standard 8.5x11 inch paper (the most common size for home/office printers in the US and Canada). You can adjust print settings to fit A4 if needed."}
            },
            {
                "@type": "Question",
                "name": "Do you have coloring pages for kids and adults?",
                "acceptedAnswer": {"@type": "Answer","text": "Absolutely! We have a dedicated section for kids (ages 3-12) with easy, educational designs, a teen section with popular IP themes (Pokemon, Sonic), and an adult section with complex mandalas and stress-relief patterns."}
            },
            {
                "@type": "Question",
                "name": "Can I upload my own image to make a custom coloring page?",
                "acceptedAnswer": {"@type": "Answer","text": "Yes! Use our 'Custom Coloring Page Maker' tool to upload your own image (photos, drawings) and convert it into a printable coloring page—free to use, no design skills needed."}
            },
            {
                "@type": "Question",
                "name": "Are the coloring pages good for educational use?",
                "acceptedAnswer": {"@type": "Answer","text": "Yes! Many of our kids' coloring pages are labeled with learning skills (e.g., 'Letter Recognition', 'Math: Addition')—perfect for classrooms, homeschooling, or at-home learning in the US and Canada."}
            }
        ]
    }
    </script>
</head>
<body class="font-inter bg-neutral text-gray-800">
    <!-- Header (Sticky + Responsive) -->
    <header class="sticky top-0 z-50 bg-white shadow-sm">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
          <div class="flex justify-between items-center py-4">
            <a
              href="https://coloringpagesprintable.online/"
              class="flex items-center space-x-2"
            >
              <i class="fa-solid fa-palette text-primary text-2xl"></i>
              <span class="text-xl font-bold text-gray-900"
                >ColoringPagesPrintable</span
              >
            </a>
            <nav class="hidden md:flex items-center space-x-8">
              <a
                href="./free-printables.html"
                class="font-medium text-gray-700 hover:text-primary transition-colors"
                >Popular Printables</a
              >
              <a
                href="/#for-kids"
                class="font-medium text-gray-700 hover:text-primary transition-colors"
                >For Kids</a
              >
              <a
                href="/#for-adults"
                class="font-medium text-gray-700 hover:text-primary transition-colors"
                >For Adults</a
              >
              <a
                href="#"
                class="font-medium text-gray-700 hover:text-primary transition-colors"
                >Custom Coloring</a
              >
              <a
                href="#"
                class="font-medium text-primary font-semibold"
                >Free Downloads</a
              >
              <a
                href="#"
                class="bg-secondary hover:bg-secondary/90 text-white font-semibold px-5 py-2 rounded-lg transition-colors"
              >
                <i class="fa-solid fa-download mr-2"></i> Free PDFs
              </a>
            </nav>
            <div class="flex items-center space-x-4">
              <div class="relative hidden sm:block">
                <input
                  type="text"
                  placeholder="Search coloring pages..."
                  class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-transparent outline-none transition-all"
                />
                <i
                  class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
                ></i>
              </div>
              <button
                id="mobile-menu-btn"
                class="md:hidden text-gray-700 focus:outline-none"
              >
                <i class="fa-solid fa-bars text-xl"></i>
              </button>
            </div>
          </div>
          <div id="mobile-menu" class="hidden md:hidden pb-4">
            <nav class="flex flex-col space-y-3">
              <a
                href="./free-printables.html"
                class="font-medium text-gray-700 hover:text-primary transition-colors py-2"
                >Popular Printables</a
              >
              <a
                href="/#for-kids"
                class="font-medium text-gray-700 hover:text-primary transition-colors py-2"
                >For Kids</a
              >
              <a
                href="/#for-adults"
                class="font-medium text-gray-700 hover:text-primary transition-colors py-2"
                >For Adults</a
              >
              <a
                href="/#custom-maker"
                class="font-medium text-gray-700 hover:text-primary transition-colors py-2"
                >Custom Coloring</a
              >
              <a href="/free-printables.html" class="font-medium text-primary py-2"
                >Free Downloads</a
              >
              <div class="relative mt-2">
                <input
                  type="text"
                  placeholder="Search coloring pages..."
                  class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-transparent outline-none"
                />
                <i
                  class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
                ></i>
              </div>
              <a
                href="/free-printables.html"
                class="bg-secondary hover:bg-secondary/90 text-white font-semibold px-5 py-2 rounded-lg text-center transition-colors mt-2"
              >
                <i class="fa-solid fa-download mr-2"></i> Free PDFs
              </a>
            </nav>
          </div>
        </div>
      </header>

    <!-- Hero Section (Core Keyword Focus) -->
    <section class="bg-gradient-to-r from-primary/10 to-secondary/10 py-12 md:py-20">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div class="space-y-6">
                    <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold text-gray-900 leading-tight text-shadow">
                        Free <span class="text-primary">Printable Coloring Pages</span> for Everyone
                    </h1>
                    <p class="text-lg md:text-xl text-gray-700 max-w-lg">
                        Download 100% free coloring sheets for kids (3-12), teens, and adults—no sign-up. Popular themes: unicorn, Pokemon, Christmas, and educational designs optimized for US 8.5x11 inch printers.
                    </p>
                    <div class="flex flex-wrap gap-4">
                        <a href="/free-printables.html" class="bg-primary hover:bg-primary/90 text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all">
                            <i class="fa-solid fa-child mr-2"></i> Kids Coloring Pages
                        </a>
                        <a href="/free-printables.html" class="bg-white hover:bg-gray-50 text-primary font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all border border-primary/20">
                            <i class="fa-solid fa-user mr-2"></i> Adult Designs
                        </a>
                    </div>
                    <!-- Trust Signals -->
                    <div class="flex items-center space-x-4 pt-2">
                        <div class="flex -space-x-2">
                            <img src="https://picsum.photos/seed/user1/40/40" alt="User" class="w-8 h-8 rounded-full border-2 border-white">
                            <img src="https://picsum.photos/seed/user2/40/40" alt="User" class="w-8 h-8 rounded-full border-2 border-white">
                            <img src="https://picsum.photos/seed/user3/40/40" alt="User" class="w-8 h-8 rounded-full border-2 border-white">
                            <div class="w-8 h-8 rounded-full bg-gray-100 border-2 border-white flex items-center justify-center text-xs font-bold text-gray-600">
                                5k+
                            </div>
                        </div>
                        <p class="text-sm text-gray-600">Trusted by parents and teachers in the US & Canada</p>
                    </div>
                </div>
                <div class="relative rounded-xl overflow-hidden shadow-xl">
                    <img 
                        src="./image/1-Collage of IP-Inspired Coloring Page Thumbnails.png" 
                        alt="Free printable coloring pages collection - unicorn-like fantasy, Q版 cartoon, Christmas, and mandala styles for kids, teens, adults (8.5x11 inch) | coloringpagesprintable.online" 
                        class="w-full h-auto object-cover hover-lift"
                        loading="lazy">
                    <span class="free-badge">100% Free</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Popular Printables (High-Search Keywords) -->
    <section id="popular" class="py-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Popular Coloring Pages</h2>
                <p class="text-lg text-gray-700">Our most downloaded free printable coloring sheets—sorted by US/CA user favorites</p>
                <!-- Multi-Dimension Filter (受众+主题+难度) -->
                <div class="flex flex-wrap justify-center gap-3 mt-8">
                    <select id="audience-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-transparent outline-none filter-button">
                        <option value="all">All Audiences</option>
                        <option value="kids">Kids (3-12)</option>
                        <option value="teens">Teens (13-17)</option>
                        <option value="adults">Adults</option>
                    </select>
                    <select id="theme-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-transparent outline-none filter-button">
                        <option value="all">All Themes</option>
                        <option value="unicorn">Unicorn</option>
                        <option value="pokemon">Pokemon</option>
                        <option value="mandala">Mandala</option>
                        <option value="christmas">Christmas</option>
                        <option value="educational">Educational</option>
                    </select>
                    <select id="difficulty-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-transparent outline-none filter-button">
                        <option value="all">All Difficulties</option>
                        <option value="easy">Easy (Ages 3-6)</option>
                        <option value="medium">Medium (Ages 7-12)</option>
                        <option value="hard">Hard (Teens & Adults)</option>
                    </select>
                </div>
            </div>

            <!-- Popular Cards Grid -->
            <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Card 1: Unicorn (1M+ searches) -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden hover-lift relative">
                    <span class="free-badge">Free</span>
                    <img 
                        id="img-popular-unicorn"
                        src="./image/2-Simple Magical Creature Coloring Page for Kids (3-7.png" 
                        alt="Free printable unicorn-like coloring page for kids 3-7 - thick outlines, rainbow mane, stars | coloringpagesprintable.online" 
                        class="w-full h-48 object-cover"
                        loading="lazy">
                    <div class="p-5">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-xs font-medium bg-pink-100 text-pink-700 px-2 py-1 rounded">Kids (Easy)</span>
                            <div class="flex items-center text-yellow-500">
                                <i class="fa-solid fa-star"></i>
                                <span class="text-sm ml-1">4.9 (1.2k reviews)</span>
                            </div>
                        </div>
                        <h3 class="font-bold text-lg mb-2">Unicorn Magic Coloring Page</h3>
                        <p class="text-gray-600 text-sm mb-4">Easy unicorn design with sparkles—perfect for ages 3-7.</p>
                        <div class="flex justify-between items-center">
                            <a href="#" class="download-pdf-btn text-primary font-medium hover:underline flex items-center" data-image-id="img-popular-unicorn">
                                Download PDF <i class="fa-solid fa-download ml-2 text-sm"></i>
                            </a>
                            <span class="text-xs text-gray-500">8.5x11 in</span>
                        </div>
                    </div>
                </div>
                <!-- Card 2: Pokemon (500k searches) -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden hover-lift relative">
                    <span class="free-badge">Free</span>
                    <img 
                        id="img-popular-pikachu"
                        src="./image/3-Q 版 Cartoon Pet-Inspired Coloring Page for Kids (8-12).png" 
                        alt="Free printable Q版 cartoon coloring page for kids 8-12 - round face, large ears, cloud accents | coloringpagesprintable.online" 
                        class="w-full h-48 object-cover"
                        loading="lazy">
                    <div class="p-5">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-xs font-medium bg-blue-100 text-blue-700 px-2 py-1 rounded">Teens (Medium)</span>
                            <div class="flex items-center text-yellow-500">
                                <i class="fa-solid fa-star"></i>
                                <span class="text-sm ml-1">4.8 (980 reviews)</span>
                            </div>
                        </div>
                        <h3 class="font-bold text-lg mb-2">Pikachu Pokemon Coloring Page</h3>
                        <p class="text-gray-600 text-sm mb-4">Official Pikachu design for Pokemon fans ages 10+.</p>
                        <div class="flex justify-between items-center">
                            <a href="#" class="download-pdf-btn text-primary font-medium hover:underline flex items-center" data-image-id="img-popular-pikachu">
                                Download PDF <i class="fa-solid fa-download ml-2 text-sm"></i>
                            </a>
                            <span class="text-xs text-gray-500">8.5x11 in</span>
                        </div>
                    </div>
                </div>
                <!-- Card 3: Mandala (300k searches) -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden hover-lift relative">
                    <span class="free-badge">Free</span>
                    <img 
                        id="img-popular-mandala"
                        src="./image/5-Intricate Adult Coloring Page Symmetrical Mandala with Floral and Geometric Elements.png" 
                        alt="Free printable mandala-like coloring page for adults - intricate floral, geometric patterns for stress relief | coloringpagesprintable.online" 
                        class="w-full h-48 object-cover"
                        loading="lazy">
                    <div class="p-5">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-xs font-medium bg-purple-100 text-purple-700 px-2 py-1 rounded">Adults (Hard)</span>
                            <div class="flex items-center text-yellow-500">
                                <i class="fa-solid fa-star"></i>
                                <span class="text-sm ml-1">4.7 (750 reviews)</span>
                            </div>
                        </div>
                        <h3 class="font-bold text-lg mb-2">Complex Mandala Coloring Page</h3>
                        <p class="text-gray-600 text-sm mb-4">Intricate mandala for stress relief—adult-friendly.</p>
                        <div class="flex justify-between items-center">
                            <a href="#" class="download-pdf-btn text-primary font-medium hover:underline flex items-center" data-image-id="img-popular-mandala">
                                Download PDF <i class="fa-solid fa-download ml-2 text-sm"></i>
                            </a>
                            <span class="text-xs text-gray-500">8.5x11 in</span>
                        </div>
                    </div>
                </div>
                <!-- Card 4: ABC Educational (50k searches) -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden hover-lift relative">
                    <span class="free-badge">Free</span>
                    <img 
                        id="img-popular-abc"
                        src="./image/15-Children's Educational Coloring Page Letters Numbers and Animals.png" 
                        alt="Free printable educational coloring page for kids 5-8 - ABC letters, numbers 1-10 with animal counts, thick lines for easy coloring | coloringpagesprintable.online" 
                        class="w-full h-48 object-cover"
                        loading="lazy">
                    <div class="p-5">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-xs font-medium bg-green-100 text-green-700 px-2 py-1 rounded">Kids (Easy)</span>
                            <div class="flex items-center text-yellow-500">
                                <i class="fa-solid fa-star"></i>
                                <span class="text-sm ml-1">4.9 (620 reviews)</span>
                            </div>
                        </div>
                        <h3 class="font-bold text-lg mb-2">ABC Alphabet Coloring Worksheet</h3>
                        <p class="text-gray-600 text-sm mb-4">Educational coloring page for learning letters—ages 4-6.</p>
                        <div class="flex justify-between items-center">
                            <a href="#" class="download-pdf-btn text-primary font-medium hover:underline flex items-center" data-image-id="img-popular-abc">
                                Download PDF <i class="fa-solid fa-download ml-2 text-sm"></i>
                            </a>
                            <span class="text-xs text-gray-500">8.5x11 in</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center mt-10">
                <a href="/free-printables.html" class="inline-block bg-white hover:bg-gray-50 text-primary font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all border border-primary/20">
                    View All Free Printables <i class="fa-solid fa-arrow-right ml-2"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- For Kids Section (Long-Tail: coloring pages for kids) -->
    <section id="for-kids" class="py-16 bg-white">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div class="order-2 md:order-1">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6">Coloring Pages for Kids</h2>
                    <p class="text-lg text-gray-700 mb-6">
                        Our kid-friendly coloring sheets are designed for ages 3-12—easy designs with large lines, educational themes, and US standard 8.5x11 inch sizing. Perfect for classrooms, homeschooling, or rainy days.
                    </p>
                    <!-- Difficulty & Educational Labels -->
                    <div class="space-y-4 mb-8">
                        <div class="flex items-start space-x-3">
                            <i class="fa-solid fa-check-circle text-green-500 mt-1"></i>
                            <div>
                                <h4 class="font-semibold text-lg text-gray-900">Age-Appropriate Designs</h4>
                                <p class="text-gray-600">Easy (3-6), Medium (7-9), and Advanced (10-12) options with age-specific themes.</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <i class="fa-solid fa-check-circle text-green-500 mt-1"></i>
                            <div>
                                <h4 class="font-semibold text-lg text-gray-900">Educational Benefits</h4>
                                <p class="text-gray-600">ABCs, numbers, shapes, and animal facts integrated into fun coloring activities.</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <i class="fa-solid fa-check-circle text-green-500 mt-1"></i>
                            <div>
                                <h4 class="font-semibold text-lg text-gray-900">Safe & Wholesome</h4>
                                <p class="text-gray-600">All kids' coloring pages are reviewed to ensure appropriate content for all ages.</p>
                            </div>
                        </div>
                    </div>
                    <a href="/free-printables.html" class="bg-primary hover:bg-primary/90 text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all inline-block">
                        Browse Kids Printables <i class="fa-solid fa-arrow-right ml-2"></i>
                    </a>
                </div>
                <div class="order-1 md:order-2">
                    <img 
                        src="./image/16-Pop Culture Coloring Page for Teens Music & Geometric Patterns.png" 
                        alt="Free printable pop culture coloring page for teens 13-17 - music themes, geometric patterns, trendy design | coloringpagesprintable.online" 
                        class="w-full h-auto rounded-xl shadow-xl hover-lift"
                        loading="lazy">
                </div>
            </div>
        </div>
    </section>

    <!-- For Adults Section (Long-Tail: adult coloring pages) -->
    <section id="for-adults" class="py-16 bg-neutral">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div>
                    <img 
                        src="./image/17-Family-Friendly Interactive Coloring Page Park Picnic Scene.png" 
                        alt="Free printable family interactive coloring page - puzzle-style picnic scene, multi-age friendly design for shared activity | coloringpagesprintable.online" 
                        class="w-full h-auto rounded-xl shadow-xl hover-lift"
                        loading="lazy">
                </div>
                <div>
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6">Coloring Pages for Adults</h2>
                    <p class="text-lg text-gray-700 mb-6">
                        Unwind with our complex, detailed coloring pages for adults. Designed for stress relief, these patterns feature mandalas, landscapes, and abstract art—optimized for 8.5x11 inch printing.
                    </p>
                    <!-- Adult-Focused Features -->
                    <div class="space-y-4 mb-8">
                        <div class="flex items-start space-x-3">
                            <i class="fa-solid fa-check-circle text-green-500 mt-1"></i>
                            <div>
                                <h4 class="font-semibold text-lg text-gray-900">Stress Relief Designs</h4>
                                <p class="text-gray-600">Intricate patterns that promote mindfulness—perfect after a long day.</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <i class="fa-solid fa-check-circle text-green-500 mt-1"></i>
                            <div>
                                <h4 class="font-semibold text-lg text-gray-900">High-Resolution PDFs</h4>
                                <p class="text-gray-600">Crisp details even when printed at 8.5x11 inches or larger.</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <i class="fa-solid fa-check-circle text-green-500 mt-1"></i>
                            <div>
                                <h4 class="font-semibold text-lg text-gray-900">No Childish Themes</h4>
                                <p class="text-gray-600">Mandalas, vintage patterns, nature scenes—adult-appropriate designs.</p>
                            </div>
                        </div>
                    </div>
                    <a href="/free-printables.html" class="bg-primary hover:bg-primary/90 text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all inline-block">
                        Browse Adult Printables <i class="fa-solid fa-arrow-right ml-2"></i>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Custom Coloring Page Maker (User Upload Feature) -->

    <section id="custom-maker" class="py-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Create Your Own Number Coloring Page</h2>
                <p class="text-lg text-gray-700">Upload any image (photo, drawing, logo) and turn it into a printable number coloring page—free, with no design skills needed.</p>
            </div>

            <div class="max-w-5xl mx-auto bg-white rounded-2xl p-6 md:p-8 shadow-2xl">
                <!-- Step 1: Upload & Settings -->
                <div id="setup-step">
                    <div id="upload-area" class="text-center p-6 border-2 border-dashed border-gray-300 rounded-xl hover:border-primary transition-colors">
                        <label for="image-upload" class="cursor-pointer">
                            <i class="fa-solid fa-cloud-upload text-4xl text-gray-400 mb-3"></i>
                            <p class="text-gray-700 font-medium">Drag & drop your image here or click to upload</p>
                            <p class="text-gray-500 text-sm mt-1">Supports JPG, PNG (Max 5MB)</p>
                            <input type="file" id="image-upload" accept="image/*" class="hidden">
                        </label>
                    </div>
                    
                    <div id="image-preview-container" class="mt-6 text-center hidden">
                        <p class="font-medium text-gray-800 mb-2">Image Preview:</p>
                        <img id="image-preview" src="" alt="Image preview" class="max-w-xs h-auto rounded-lg mx-auto shadow-md">
                    </div>

                    <div class="grid md:grid-cols-2 gap-4 mt-6">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2" for="difficulty">Difficulty Level</label>
                            <select id="difficulty" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-transparent outline-none">
                                <option value="easy">Easy (Thick lines, large areas)</option>
                                <option value="medium" selected>Medium (Balanced detail)</option>
                                <option value="hard">Hard (Fine lines, intricate details)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2" for="size">Paper Size</label>
                            <select id="size" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-transparent outline-none">
                                <option value="us-letter" selected>US Letter (8.5x11 inch)</option>
                                <option value="a4">A4 (210x297mm)</option>
                            </select>
                        </div>
                    </div>

                    <button type="button" id="generate-btn" class="w-full bg-secondary hover:bg-secondary/90 text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all mt-6">
                        <i class="fa-solid fa-magic mr-2"></i> Generate Number Coloring Page
                    </button>
                </div>
                
                <!-- Step 2: Loading -->
                <div id="loading" class="text-center hidden py-8">
                    <i class="fa-solid fa-spinner fa-spin text-4xl text-primary mb-4"></i>
                    <p id="status" class="text-gray-700 font-medium text-lg">Generating your coloring page...</p>
                </div>
                
                <!-- Step 3: Results -->
                <div id="result" class="hidden">
                    <h3 class="font-bold text-xl text-gray-900 mb-4 text-center">Your Coloring Page is Ready!</h3>
                    
                    <div class="grid md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-gray-50 p-3 rounded-lg shadow-inner">
                            <h4 class="font-bold text-center text-gray-700 mb-2">Original Reference</h4>
                            <canvas id="result-original" class="w-full h-auto rounded-md border"></canvas>
                        </div>
                         <div class="bg-gray-50 p-3 rounded-lg shadow-inner">
                            <h4 class="font-bold text-center text-gray-700 mb-2">Number Coloring Page</h4>
                            <canvas id="canvasOutput" class="w-full h-auto rounded-md border"></canvas>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="font-bold text-lg text-gray-800 mb-3">Color Palette</h4>
                        <div id="palette" class="flex flex-wrap gap-3"></div>
                    </div>
                    
                    <div class="grid sm:grid-cols-2 gap-4">
                        <button type="button" id="start-over-btn" class="w-full bg-accent hover:bg-accent/90  font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all text-center">
                            <i class="fa-solid fa-arrow-rotate-left mr-2"></i> Start Over
                        </button>
                        <a href="#" id="download-custom" class="block w-full bg-primary hover:bg-primary/90  font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all text-center">
                            <i class="fa-solid fa-download mr-2"></i> Download PDF
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <canvas id="canvasInput" class="hidden"></canvas>
    

    <!-- FAQ Section (High-Search Intent) -->
    <section class="py-16 bg-neutral">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Frequently Asked Questions</h2>
                <p class="text-lg text-gray-700">Answers to common questions about our free printable coloring pages</p>
            </div>
            <div class="max-w-3xl mx-auto space-y-6">
                <!-- FAQ Item 1 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h3 class="font-bold text-xl mb-3 text-gray-900">Are your coloring pages printable free to download?</h3>
                    <p class="text-gray-700">
                        Yes! All coloring pages on our site are 100% free to download and print—no sign-up, registration, or payment required. Simply click the "Download PDF" button on any resource page to save the file to your device.
                    </p>
                </div>
                <!-- FAQ Item 2 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h3 class="font-bold text-xl mb-3 text-gray-900">What size are the printable coloring pages?</h3>
                    <p class="text-gray-700">
                        Our coloring pages are optimized for <strong>US standard 8.5x11 inch paper</strong>—the most common size for home and office printers in the US and Canada. You can adjust your printer settings to fit A4 paper if needed (no quality loss).
                    </p>
                </div>
                <!-- FAQ Item 3 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h3 class="font-bold text-xl mb-3 text-gray-900">Do you have coloring pages for kids and adults?</h3>
                    <p class="text-gray-700">
                        Absolutely! We have three main sections: 
                        <ul class="list-disc pl-6 mt-2 space-y-1 text-gray-700">
                            <li><strong>Kids (3-12):</strong> Easy designs with large lines, educational themes (ABCs, math), and age-appropriate difficulty levels.</li>
                            <li><strong>Teens (13-17):</strong> Popular IP themes (Pokemon, Sonic, Minecraft) and medium-difficulty designs.</li>
                            <li><strong>Adults:</strong> Complex mandalas, nature scenes, and abstract patterns for stress relief—no childish themes.</li>
                        </ul>
                    </p>
                </div>
                <!-- FAQ Item 4 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h3 class="font-bold text-xl mb-3 text-gray-900">Can I upload my own image to make a custom coloring page?</h3>
                    <p class="text-gray-700">
                        Yes! Use our "Custom Coloring Page Maker" tool (above) to upload any image (photos of family, pet drawings, logos) and convert it into a printable coloring page. You can choose difficulty levels (easy/medium/hard) and paper size—free to use, no design skills needed.
                    </p>
                </div>
                <!-- FAQ Item 5 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h3 class="font-bold text-xl mb-3 text-gray-900">Are the coloring pages good for educational use?</h3>
                    <p class="text-gray-700">
                        Yes! Many of our kids' coloring pages are labeled with specific learning skills (e.g., "Skills: Letter Recognition," "Math: Addition")—perfect for classrooms, homeschooling, or at-home learning in the US and Canada. Teachers can download and print as many copies as needed for their students.
                    </p>
                </div>
                <!-- FAQ Item 6 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h3 class="font-bold text-xl mb-3 text-gray-900">What file format are the coloring pages in?</h3>
                    <p class="text-gray-700">
                        All coloring pages are available as <strong>PDF files</strong>—the best format for printing (preserves quality and layout across all devices). You can open PDFs with free software like Adobe Acrobat Reader, Preview (Mac), or Google Drive.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section (Free Downloads) -->
    <section class="py-16 bg-gradient-to-r from-primary/10 to-secondary/10 text-center">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6">Start Downloading Free Coloring Pages</h2>
            <p class="text-lg text-gray-700 max-w-2xl mx-auto mb-8">
                100% free, no sign-up—find the perfect coloring sheets for your family, classroom, or stress-relief routine. Optimized for US/CA printers (8.5x11 inch).
            </p>
            <div class="flex flex-wrap justify-center gap-4">
                <a href="/free-printables.html" class="bg-white hover:bg-gray-50 text-primary font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all border border-primary/20">
                    <i class="fa-solid fa-child mr-2"></i> Kids Printables
                </a>
                <a href="/free-printables.html" class="bg-white hover:bg-gray-50 text-primary font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all border border-primary/20">
                    <i class="fa-solid fa-user mr-2"></i> Adult Printables
                </a>
                <a href="/free-printables.html" class="bg-white hover:bg-gray-50 text-primary font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all border border-primary/20">
                    <i class="fa-solid fa-snowflake mr-2"></i> Holiday Themes
                </a>
                <a href="#custom-maker" class="bg-white hover:bg-gray-50 text-primary font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all border border-primary/20">
                    <i class="fa-solid fa-magic mr-2"></i> Custom Designs
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <i class="fa-solid fa-palette text-primary text-2xl"></i>
                        <span class="text-xl font-bold">ColoringPagesPrintable</span>
                    </div>
                    <p class="text-gray-400 mb-4">
                        Free and custom printable coloring pages for all ages. No sign-up required.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-primary transition-colors" rel="noopener noreferrer">
                            <i class="fa-facebook-f"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary transition-colors" rel="noopener noreferrer">
                            <i class="fa-twitter"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary transition-colors" rel="noopener noreferrer">
                            <i class="fa-instagram"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-primary transition-colors" rel="noopener noreferrer">
                            <i class="fa-pinterest"></i>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="/" class="text-gray-400 hover:text-primary transition-colors">Home</a></li>
                        <li><a href="/free-printables.html" class="text-gray-400 hover:text-primary transition-colors">Kids Coloring Pages</a></li>
                        <li><a href="/free-printables.html" class="text-gray-400 hover:text-primary transition-colors">Adult Coloring Sheets</a></li>
                        <li><a href="/#custom-maker" class="text-gray-400 hover:text-primary transition-colors">Custom Coloring Maker</a></li>
                        <li><a href="" class="text-gray-400 hover:text-primary transition-colors">FAQ</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Popular Themes</h3>
                    <ul class="space-y-2">
                        <li><a href="/free-printables.html" class="text-gray-400 hover:text-primary transition-colors">Unicorn Coloring Pages</a></li>
                        <li><a href="/free-printables.html" class="text-gray-400 hover:text-primary transition-colors">Pokemon Coloring Sheets</a></li>
                        <li><a href="/free-printables.html" class="text-gray-400 hover:text-primary transition-colors">Mandala Designs</a></li>
                        <li><a href="/free-printables.html" class="text-gray-400 hover:text-primary transition-colors">Christmas Coloring Pages</a></li>
                        <li><a href="/free-printables.html" class="text-gray-400 hover:text-primary transition-colors">Educational Printables</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Legal</h3>
                    <ul class="space-y-2">
                        <li><a href="/terms.html" class="text-gray-400 hover:text-primary transition-colors">Terms of Service</a></li>
                        <li><a href="/privacy.html" class="text-gray-400 hover:text-primary transition-colors">Privacy Policy</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-primary transition-colors">Copyright Information</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-primary transition-colors">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-12 pt-8 text-center text-gray-500 text-sm">
                <p>&copy; 2024 ColoringPagesPrintable.online. All rights reserved. For personal/educational use only. Compliant with US CCPA and Canada PIPEDA.</p>
            </div>
        </div>
    </footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        // --- YOUR ORIGINAL JAVASCRIPT ---
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
            const icon = mobileMenuBtn.querySelector('i');
            icon.classList.toggle('fa-bars');
            icon.classList.toggle('fa-times');
        });

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    window.scrollTo({
                        top: target.offsetTop - 80,
                        behavior: 'smooth'
                    });
                    if (!mobileMenu.classList.contains('hidden')) {
                        mobileMenu.classList.add('hidden');
                        const icon = mobileMenuBtn.querySelector('i');
                        icon.classList.add('fa-bars');
                        icon.classList.remove('fa-times');
                    }
                }
            });
        });
        
        // --- NEW AND CORRECTED JAVASCRIPT FOR PDF DOWNLOAD ---
        document.addEventListener('DOMContentLoaded', () => {
            const downloadButtons = document.querySelectorAll('.download-pdf-btn');

            downloadButtons.forEach(button => {
                button.addEventListener('click', function(event) {
                    event.preventDefault();

                    const imageId = this.dataset.imageId;
                    const imageElement = document.getElementById(imageId);

                    if (!imageElement) {
                        console.error('Image element not found for ID:', imageId);
                        alert('Sorry, there was an error preparing the download.');
                        return;
                    }
                    
                    const cardBody = this.closest('.p-5'); 
                    if (!cardBody) {
                        console.error('Could not find parent card body with class .p-5');
                        alert('Sorry, an error occurred (code: card-body-not-found).');
                        return;
                    }

                    const titleElement = cardBody.querySelector('h3');
                    if(!titleElement) {
                        console.error('Could not find h3 title element inside the card body.');
                        alert('Sorry, an error occurred (code: title-not-found).');
                        return;
                    }

                    const title = titleElement.textContent.trim();
                    const filename = `${title.replace(/\s+/g, '-')}-Coloring-Page.pdf`;

                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF('p', 'mm', 'a4');
                    
                    const img = new Image();
                    img.crossOrigin = "Anonymous";
                    img.src = imageElement.src;

                    img.onload = () => {
                        const pageWidth = doc.internal.pageSize.getWidth();
                        const pageHeight = doc.internal.pageSize.getHeight();
                        const margin = 10;
                        const usableWidth = pageWidth - (margin * 2);
                        const usableHeight = pageHeight - (margin * 2);
                        const imageRatio = img.width / img.height;
                        const pageRatio = usableWidth / usableHeight;
                        let imgWidth, imgHeight;

                        if (imageRatio > pageRatio) {
                            imgWidth = usableWidth;
                            imgHeight = imgWidth / imageRatio;
                        } else {
                            imgHeight = usableHeight;
                            imgWidth = imgHeight * imageRatio;
                        }
                        
                        const x = (pageWidth - imgWidth) / 2;
                        const y = (pageHeight - imgHeight) / 2;

                        doc.addImage(img, 'PNG', x, y, imgWidth, imgHeight);
                        doc.save(filename);
                    };
                    
                    img.onerror = () => {
                         console.error('Could not load image for PDF generation. This is likely a browser security issue when running from a local file (file://). Please use a local server like VS Code Live Server.');
                         alert('Sorry, the image could not be loaded. Please ensure you are running this page from a web server (e.g., using "Live Server" in VS Code) and not as a local file.');
                    }
                });
            });
        });


        const imageUploadEl = document.getElementById('image-upload');
    const uploadArea = document.getElementById('upload-area');
    const imagePreviewContainer = document.getElementById('image-preview-container');
    const imagePreview = document.getElementById('image-preview');
    const difficultyEl = document.getElementById('difficulty');
    const sizeEl = document.getElementById('size');
    const generateBtn = document.getElementById('generate-btn');
    const downloadLink = document.getElementById('download-custom');
    const startOverBtn = document.getElementById('start-over-btn');
    const setupStepEl = document.getElementById('setup-step');
    const loadingEl = document.getElementById('loading');
    const resultEl = document.getElementById('result');
    const statusEl = document.getElementById('status');
    const paletteEl = document.getElementById('palette');
    const canvasInput = document.getElementById('canvasInput');
    const canvasOutput = document.getElementById('canvasOutput');
    const resultOriginalCanvas = document.getElementById('result-original');

    // === Core Logic Variables ===
    let loadedImage = null;
    let colorGroups = [];

    // === Event Listeners ===
    imageUploadEl.addEventListener('change', handleImageUpload);
    generateBtn.addEventListener('click', handleGenerateClick);
    downloadLink.addEventListener('click', handleDownloadPdf);
    startOverBtn.addEventListener('click', resetToInitialState);
    
    uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); e.stopPropagation(); uploadArea.classList.add('border-primary'); });
    uploadArea.addEventListener('dragleave', (e) => { e.preventDefault(); e.stopPropagation(); uploadArea.classList.remove('border-primary'); });
    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault(); e.stopPropagation();
        uploadArea.classList.remove('border-primary');
        const files = e.dataTransfer.files;
        if (files.length > 0) {
            imageUploadEl.files = files;
            handleImageUpload({ target: imageUploadEl });
        }
    });

    // === Functional Functions ===
    function resetToInitialState() {
        // Hide result and loading, show setup
        resultEl.classList.add('hidden');
        loadingEl.classList.add('hidden');
        setupStepEl.classList.remove('hidden');

        // Reset file input and preview
        imageUploadEl.value = null;
        imagePreview.src = '';
        imagePreviewContainer.classList.add('hidden');
        uploadArea.querySelector('p.font-medium').textContent = 'Drag & drop your image here or click to upload';

        // Clear canvases and palette
        const outCtx = canvasOutput.getContext('2d');
        outCtx.clearRect(0, 0, canvasOutput.width, canvasOutput.height);
        const origCtx = resultOriginalCanvas.getContext('2d');
        origCtx.clearRect(0, 0, resultOriginalCanvas.width, resultOriginalCanvas.height);
        paletteEl.innerHTML = '';

        // Reset state variables
        loadedImage = null;
        colorGroups = [];
    }

    function handleImageUpload(e) {
        const file = e.target.files && e.target.files[0];
        if (!file) return;
        const url = URL.createObjectURL(file);
        const img = new Image();
        img.onload = () => {
            loadedImage = img;
            imagePreview.src = url;
            imagePreviewContainer.classList.remove('hidden');
            uploadArea.querySelector('p.font-medium').textContent = `Selected: ${file.name}`;
        };
        img.src = url;
    }
    
    async function handleDownloadPdf(e) {
        e.preventDefault();
        setStatus('Generating PDF...');
        const { jsPDF } = window.jspdf;
        const paperSize = sizeEl.value;
        const orientation = canvasOutput.width > canvasOutput.height ? 'landscape' : 'portrait';
        const doc = new jsPDF({ orientation, unit: 'px', format: paperSize === 'a4' ? 'a4' : 'letter' });
        
        const pageWidth = doc.internal.pageSize.getWidth();
        const pageHeight = doc.internal.pageSize.getHeight();
        const margin = 40;

        doc.setFontSize(22);
        doc.setFont('helvetica', 'bold');
        doc.text('Your Custom Coloring Page', pageWidth / 2, margin, { align: 'center' });

        const mainImgRatio = Math.min((pageWidth / 2 - margin * 1.5) / canvasOutput.width, (pageHeight - margin * 2) / canvasOutput.height);
        const mainImgWidth = canvasOutput.width * mainImgRatio;
        const mainImgHeight = canvasOutput.height * mainImgRatio;
        const mainImgX = pageWidth / 2 + margin / 2;
        const mainImgY = margin + 30;
        doc.addImage(canvasOutput.toDataURL('image/png'), 'PNG', mainImgX, mainImgY, mainImgWidth, mainImgHeight);
        
        const refImgWidth = mainImgWidth * 0.5;
        const refImgHeight = mainImgHeight * 0.5;
        const refImgX = margin;
        const refImgY = mainImgY;
        doc.setFontSize(12);
        doc.setFont('helvetica', 'normal');
        doc.text('Original Image', refImgX, refImgY - 5);
        doc.addImage(canvasInput.toDataURL('image/png'), 'PNG', refImgX, refImgY, refImgWidth, refImgHeight);

        const paletteYStart = refImgY + refImgHeight + 40;
        doc.text('Color Key', refImgX, paletteYStart - 10);
        let currentY = paletteYStart;
        const swatchSize = 20;
        const itemHeight = 25;
        
        for(const [index, group] of colorGroups.entries()) {
            if (currentY + itemHeight > pageHeight - margin) { break; }
            const [b,g,r] = group.avgColor;
            doc.setFillColor(r, g, b);
            doc.rect(refImgX, currentY, swatchSize, swatchSize, 'F');
            doc.setFont('courier', 'normal');
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            const hex = '#' + ((1<<24) | (r<<16) | (g<<8) | b).toString(16).slice(1).toUpperCase();
            doc.text(`${index + 1}: ${hex}`, refImgX + swatchSize + 10, currentY + swatchSize / 2, { baseline: 'middle' });
            currentY += itemHeight;
        }

        doc.save('coloring-page.pdf');
        setStatus('Done!');
    }

    function handleGenerateClick() {
        if (!loadedImage) { alert('Please upload an image first!'); return; }
        setupStepEl.classList.add('hidden');
        resultEl.classList.add('hidden');
        loadingEl.classList.remove('hidden');
        waitForOpencv(() => {
            processImage().catch(err => {
                console.error(err);
                setStatus('Generation failed. Please check the console.');
                loadingEl.classList.add('hidden');
                setupStepEl.classList.remove('hidden');
            });
        });
    }

    function setStatus(text) {
        statusEl.textContent = text;
    }

    function waitForOpencv(callback) {
        if (typeof cv !== 'undefined' && cv.Mat) return callback();
        setStatus('Loading OpenCV.js...');
        const interval = setInterval(() => {
            if (typeof cv !== 'undefined' && cv.Mat) { clearInterval(interval); setStatus('OpenCV is ready'); callback(); }
        }, 200);
    }

    function colorDistance(c1, c2) {
        return Math.sqrt(Math.pow(c1[0] - c2[0], 2) + Math.pow(c1[1] - c2[1], 2) + Math.pow(c1[2] - c2[2]));
    }

    async function processImage() {
        setStatus('Processing...');
        paletteEl.innerHTML = '';
        generateBtn.disabled = true;

        const MAX_W = 800;
        const scale = loadedImage.naturalWidth > MAX_W ? MAX_W / loadedImage.naturalWidth : 1;
        const w = Math.round(loadedImage.naturalWidth * scale);
        const h = Math.round(loadedImage.naturalHeight * scale);
        canvasInput.width = w; canvasInput.height = h;
        canvasInput.getContext('2d').drawImage(loadedImage, 0, 0, w, h);

        const mats = [];
        try {
            const srcRgba = cv.imread(canvasInput); mats.push(srcRgba);
            const srcBgr = new cv.Mat(); mats.push(srcBgr);
            cv.cvtColor(srcRgba, srcBgr, cv.COLOR_RGBA2BGR);

            setStatus('Generating line art...');
            const gray = new cv.Mat(); mats.push(gray);
            const blurred = new cv.Mat(); mats.push(blurred);
            const edges = new cv.Mat(); mats.push(edges);
            cv.cvtColor(srcBgr, gray, cv.COLOR_BGR2GRAY);
            
            const difficulty = difficultyEl.value;
            let blurSize, dilateSize, colorTolerance, minAreaForNumbering;
            if (difficulty === 'easy') {
                blurSize = new cv.Size(5, 5); dilateSize = new cv.Size(4, 4); colorTolerance = 45; minAreaForNumbering = 100;
            } else if (difficulty === 'hard') {
                blurSize = new cv.Size(3, 3); dilateSize = new cv.Size(2, 2); colorTolerance = 20; minAreaForNumbering = 20;
            } else { // medium
                blurSize = new cv.Size(3, 3); dilateSize = new cv.Size(3, 3); colorTolerance = 30; minAreaForNumbering = 50;
            }
            
            cv.GaussianBlur(gray, blurred, blurSize, 0, 0, cv.BORDER_DEFAULT);
            const med = new cv.Mat(); mats.push(med);
            cv.medianBlur(gray, med, 3);
            const sigma = 0.33;
            const medianValue = Array.from(med.data).sort((a,b) => a-b)[Math.floor(med.data.length / 2)];
            const lowerThreshold = Math.max(0, (1.0 - sigma) * medianValue);
            const upperThreshold = Math.min(255, (1.0 + sigma) * medianValue);
            cv.Canny(blurred, edges, lowerThreshold, upperThreshold);

            const kernel = cv.getStructuringElement(cv.MORPH_RECT, dilateSize); mats.push(kernel);
            cv.dilate(edges, edges, kernel);
            
            setStatus('Finding color regions...');
            const contours = new cv.MatVector();
            const hierarchy = new cv.Mat(); mats.push(hierarchy);
            cv.findContours(edges, contours, hierarchy, cv.RETR_CCOMP, cv.CHAIN_APPROX_SIMPLE);
            
            const finalRegions = [];
            for (let i = 0; i < contours.size(); i++) {
                const cnt = contours.get(i);
                const area = cv.contourArea(cnt);
                if (area >= minAreaForNumbering && hierarchy.intPtr(0, i)[3] !== -1) {
                    const mask = new cv.Mat(h, w, cv.CV_8UC1, new cv.Scalar(0));
                    cv.drawContours(mask, contours, i, new cv.Scalar(255), cv.FILLED);
                    const meanColor = cv.mean(srcBgr, mask);
                    mask.delete();
                    const avgColor = [Math.round(meanColor[0]), Math.round(meanColor[1]), Math.round(meanColor[2])];
                    if (!(avgColor[0] > 240 && avgColor[1] > 240 && avgColor[2] > 240)) {
                        const M = cv.moments(cnt);
                        if (M.m00 !== 0) {
                            const cx = Math.floor(M.m10 / M.m00);
                            const cy = Math.floor(M.m01 / M.m00);
                            finalRegions.push({ centroid: { cx, cy }, avgColor, area });
                        }
                    }
                }
                cnt.delete();
            }
            contours.delete();
            
            setStatus('Grouping colors & numbering...');
            colorGroups = [];
            for (const region of finalRegions) {
                let foundGroup = false;
                for (const group of colorGroups) {
                    if (colorDistance(region.avgColor, group.avgColor) < colorTolerance) {
                        group.regions.push(region); foundGroup = true; break;
                    }
                }
                if (!foundGroup) {
                    colorGroups.push({ avgColor: region.avgColor, regions: [region] });
                }
            }
            
            setStatus('Drawing final result...');
            const finalLineArt = new cv.Mat(); mats.push(finalLineArt);
            cv.bitwise_not(edges, finalLineArt);
            const finalLineArtRgba = new cv.Mat(); mats.push(finalLineArtRgba);
            cv.cvtColor(finalLineArt, finalLineArtRgba, cv.COLOR_GRAY2RGBA);

            canvasOutput.width = w; canvasOutput.height = h;
            const outCtx = canvasOutput.getContext('2d');
            outCtx.fillStyle = 'white'; outCtx.fillRect(0, 0, w, h);
            cv.imshow(canvasOutput, finalLineArtRgba);
            
            resultOriginalCanvas.width = w; resultOriginalCanvas.height = h;
            resultOriginalCanvas.getContext('2d').drawImage(canvasInput, 0, 0, w, h);

            colorGroups.forEach((group, index) => {
                const num = index + 1;
                const [b, g, r] = group.avgColor;
                const hex = '#' + ((1<<24) | (r<<16) | (g<<8) | b).toString(16).slice(1).toUpperCase();
                const item = document.createElement('div');
                item.className = 'flex items-center gap-2 p-2 bg-gray-100 rounded-md shadow-sm';
                item.innerHTML = `<div class="w-7 h-6 rounded border border-gray-400" style="background:${hex}"></div><div class="font-mono text-sm">${num} ${hex}</div>`;
                paletteEl.appendChild(item);

                group.regions.forEach(region => {
                    const { cx, cy } = region.centroid;
                    const fontSize = Math.max(10, Math.min(20, Math.round(Math.sqrt(region.area) / 8)));
                    outCtx.font = `bold ${fontSize}px Arial`;
                    outCtx.textAlign = 'center'; outCtx.textBaseline = 'middle';
                    outCtx.lineWidth = Math.max(3, Math.round(fontSize / 7)); 
                    outCtx.strokeStyle = 'white';
                    outCtx.fillStyle = 'black';
                    outCtx.strokeText(String(num), cx, cy);
                    outCtx.fillText(String(num), cx, cy);
                });
            });
            
            loadingEl.classList.add('hidden');
            resultEl.classList.remove('hidden');

        } finally {
            try { for (let m of mats) { if (m && !m.isDeleted()) m.delete(); } } catch(e){}
            generateBtn.disabled = false;
        }
    }
    </script>
</body>
</html>